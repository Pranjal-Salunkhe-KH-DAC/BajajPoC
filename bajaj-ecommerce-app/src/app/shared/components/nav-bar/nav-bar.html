<!-- src/app/shared/components/nav-bar/nav-bar.html -->
<nav class="navbar navbar-expand-lg navbar-custom sticky-top">
  <div class="container-fluid">

    <!-- Mobile Hamburger -->
    <button class="btn-hamburger d-lg-none" (click)="toggleSidebar()" aria-label="Toggle sidebar">
      <span></span><span></span><span></span>
    </button>

    <!-- LEFT: Brand + Greeting -->
    <div class="d-flex align-items-center">
      <a class="navbar-brand me-4" routerLink="/home">
        Bajaj Store
      </a>

      <!-- USER GREETING (LEFT SIDE) -->
      @if (isLoggedIn) {
        <div class="user-greeting d-flex align-items-center">
          <div class="user-avatar me-2">
            <i class="bi bi-person-circle"></i>
          </div>
          <div class="user-info">
            <small class="text-white d-block">Welcome back</small>
            <strong class="text-white">{{ userName }}</strong>
          </div>
        </div>
      }
    </div>

    <!-- Desktop Search -->
    <div class="search-box d-none d-lg-flex mx-4 flex-grow-1">
      <input type="search" placeholder="Search products..." class="form-control" />
      <button class="btn-search">Search</button>
    </div>

    <!-- Desktop Toggler -->
    <button class="navbar-toggler" type="button" (click)="toggleMenu()"
            [attr.aria-expanded]="isMenuOpen" aria-controls="navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- RIGHT: Menu Links -->
    <div class="collapse navbar-collapse" [class.show]="isMenuOpen" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-lg-center">

        <li class="nav-item"><a class="nav-link" routerLink="/home" routerLinkActive="active" (click)="closeMenu()">Home</a></li>
        <li class="nav-item"><a class="nav-link" routerLink="/products" routerLinkActive="active" (click)="closeMenu()">Products</a></li>
        <li class="nav-item"><a class="nav-link" routerLink="/categories" routerLinkActive="active" (click)="closeMenu()">Categories</a></li>
        
        <!-- CART WITH COUNT -->
        <li class="nav-item">
          <a class="nav-link position-relative" routerLink="/cart" routerLinkActive="active" (click)="closeMenu()">
            Cart
            @if (cartCount > 0) {
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                {{ cartCount }}
                <span class="visually-hidden">items in cart</span>
              </span>
            }
          </a>
        </li>

        <li class="nav-item"><a class="nav-link" routerLink="/orders" routerLinkActive="active" (click)="closeMenu()">Orders</a></li>

        <!-- ADMIN LINK: ONLY FOR ADMIN ROLE -->
        @if (isAdmin) {
          <li class="nav-item">
            <a class="nav-link text-danger fw-bold" routerLink="/admin/admin-dashboard" (click)="closeMenu()">
              Admin Dashboard
            </a>
          </li>
        }

        <!-- AUTH LINKS -->
        @if (!isLoggedIn) {
          <li class="nav-item"><a class="nav-link" routerLink="/login" (click)="closeMenu()">Login</a></li>
          <li class="nav-item"><a class="nav-link" routerLink="/register" (click)="closeMenu()">Register</a></li>
        } @else {
          <li class="nav-item">
            <a class="btn btn-outline-light btn-sm rounded-pill px-3" 
               (click)="logout(); closeMenu()">
              <i class="bi bi-box-arrow-right me-1"></i> Logout
            </a>
          </li>
        }

      </ul>
    </div>
  </div>
</nav>

<!-- MOBILE SIDEBAR -->
<div class="sidebar-overlay" [class.active]="isSidebarOpen" (click)="closeSidebar()"></div>
<div class="mobile-sidebar" [class.open]="isSidebarOpen">
  <div class="sidebar-header">
    <h5>Menu</h5>
    <button class="btn-close-sidebar" (click)="closeSidebar()" aria-label="Close">X</button>
  </div>
  <ul class="sidebar-menu">
    <li><a routerLink="/home"       (click)="closeSidebar()">Home</a></li>
    <li><a routerLink="/products"   (click)="closeSidebar()">Products</a></li>
    <li><a routerLink="/categories" (click)="closeSidebar()">Categories</a></li>
    <li><a routerLink="/cart"       (click)="closeSidebar()">Cart</a></li>
    <li><a routerLink="/orders"     (click)="closeSidebar()">Orders</a></li>

    <!-- ADMIN LINK IN MOBILE: ONLY FOR ADMIN -->
    @if (isAdmin) {
      <li><a routerLink="/admin/admin-dashboard" (click)="closeSidebar()" class="text-danger fw-bold">Admin Dashboard</a></li>
    }

    @if (isLoggedIn) {
      <li class="p-3 text-center border-top">
        <div class="d-flex align-items-center justify-content-center mb-2">
          <i class="bi bi-person-circle me-2" style="font-size:1.5rem; color:#0d47a1;"></i>
          <div>
            <small class="d-block text-dark">Welcome back</small>
            <strong class="text-dark">{{ userName }}</strong>
          </div>
        </div>
        <a class="btn btn-outline-danger btn-sm w-100" (click)="logout(); closeSidebar()">
          Logout
        </a>
      </li>
    } @else {
      <li><hr></li>
      <li><a routerLink="/login"    (click)="closeSidebar()">Login</a></li>
      <li><a routerLink="/register" (click)="closeSidebar()">Register</a></li>
    }
  </ul>
</div>