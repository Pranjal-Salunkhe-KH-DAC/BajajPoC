<bajaj-nav-bar></bajaj-nav-bar>

<div class="container py-5">
  <h2 class="mb-4">Checkout</h2>

  @if (cartItems.length === 0) {
    <div class="alert alert-info text-center">
      <p>Your cart is empty.</p>
      <a routerLink="/products" class="btn btn-primary">Continue Shopping</a>
    </div>
  } @else {
    <div class="row">
      <div class="col-md-7">
        <div class="card mb-4">
          <div class="card-body">
            <h4 class="card-title mb-4">Shipping Information</h4>
            
            <form>
              <div class="mb-3">
                <label class="form-label">Full Name *</label>
                <input 
                  type="text" 
                  class="form-control" 
                  [(ngModel)]="shippingData.fullName"
                  name="fullName"
                  required>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Email *</label>
                  <input 
                    type="email" 
                    class="form-control" 
                    [(ngModel)]="shippingData.email"
                    name="email"
                    required>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Phone *</label>
                  <input 
                    type="tel" 
                    class="form-control" 
                    [(ngModel)]="shippingData.phone"
                    name="phone"
                    required>
                </div>
              </div>

              <div class="mb-3">
                <label class="form-label">Address *</label>
                <textarea 
                  class="form-control" 
                  rows="3" 
                  [(ngModel)]="shippingData.address"
                  name="address"
                  required></textarea>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">City *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="shippingData.city"
                    name="city"
                    required>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">State *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="shippingData.state"
                    name="state"
                    required>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Pincode *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="shippingData.pincode"
                    name="pincode"
                    required>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Country</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="shippingData.country"
                    name="country"
                    readonly>
                </div>
              </div>

              <h5 class="mt-4 mb-3">Payment Method</h5>
              <div class="form-check mb-2">
                <input 
                  class="form-check-input" 
                  type="radio" 
                  name="paymentMethod" 
                  id="cod"
                  value="cod"
                  [(ngModel)]="paymentMethod">
                <label class="form-check-label" for="cod">
                  Cash on Delivery
                </label>
              </div>
              <div class="form-check">
                <input 
                  class="form-check-input" 
                  type="radio" 
                  name="paymentMethod" 
                  id="online"
                  value="online"
                  [(ngModel)]="paymentMethod">
                <label class="form-check-label" for="online">
                  Online Payment
                </label>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="col-md-5">
        <div class="card">
          <div class="card-body">
            <h4 class="card-title mb-4">Order Summary</h4>
            
            <div class="mb-3">
              @for (item of cartItems; track item.productId) {
                <div class="d-flex align-items-center mb-3 pb-3 border-bottom">
                  <img [src]="item.image" [alt]="item.name" width="60" height="60" class="rounded me-3">
                  <div class="flex-grow-1">
                    <h6 class="mb-1">{{item.name}}</h6>
                    <small class="text-muted">Qty: {{item.quantity}}</small>
                  </div>
                  <div class="text-end">
                    <strong>₹{{(item.price * item.quantity).toFixed(2)}}</strong>
                  </div>
                </div>
              }
            </div>

            <div class="border-top pt-3">
              <div class="d-flex justify-content-between mb-2">
                <span>Subtotal:</span>
                <span>₹{{subtotal.toFixed(2)}}</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span>Shipping:</span>
                <span>₹{{shipping.toFixed(2)}}</span>
              </div>
              <div class="d-flex justify-content-between mb-3">
                <span>Tax (18%):</span>
                <span>₹{{tax.toFixed(2)}}</span>
              </div>
              <div class="d-flex justify-content-between border-top pt-3">
                <strong>Total:</strong>
                <strong class="text-success fs-5">₹{{total.toFixed(2)}}</strong>
              </div>
            </div>

            <button 
              class="btn btn-success w-100 mt-4 py-3" 
              (click)="placeOrder()"
              [disabled]="isProcessing">
              @if (isProcessing) {
                <span class="spinner-border spinner-border-sm me-2"></span>
                Processing...
              } @else {
                Place Order
              }
            </button>
          </div>
        </div>
      </div>
    </div>
  }
</div>

<bajaj-footer></bajaj-footer>