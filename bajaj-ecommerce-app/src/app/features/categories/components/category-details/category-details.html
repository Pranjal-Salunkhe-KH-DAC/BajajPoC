<bajaj-nav-bar></bajaj-nav-bar>

<div class="container py-5">
  @if (isLoading) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  } @else if (category) {
    <!-- Category Header -->
    <div class="row mb-5">
      <div class="col-12 text-center">
        <h1 class="display-5 fw-bold text-primary">{{ category.name }}</h1>
        <p class="lead text-muted">Browse our collection of {{ category.name.toLowerCase() }} products</p>
      </div>
    </div>
    
    <!-- Products Grid -->
    @if (products.length > 0) {
      <div class="row g-4">
        @for (product of products; track product._id) {
          <div class="col-md-6 col-lg-4 col-xl-3">
            <div class="card h-100 shadow-sm border-0 hover-lift">
              <div class="card-img-container">
                <img 
                  [src]="product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/300x200?text=No+Image'" 
                  class="card-img-top" 
                  [alt]="product.name"
                  style="height: 250px; object-fit: cover;">
                @if (product.discount && product.discount > 0) {
                  <div class="discount-badge">
                    <span class="badge bg-danger">{{ product.discount }}% OFF</span>
                  </div>
                }
              </div>
              
              <div class="card-body d-flex flex-column">
                <div class="flex-grow-1">
                  <h6 class="card-title fw-bold mb-2">{{ product.name }}</h6>
                  <p class="card-text text-muted small mb-3">{{ product.description | slice:0:80 }}...</p>
                  
                  <div class="price-section mb-3">
                    <div class="d-flex align-items-center justify-content-between">
                      <div>
                        <span class="text-success fs-4 fw-bold">
                          ₹{{ product.price | number:'1.0-0' }}
                        </span>
                        @if (product.discount && product.discount > 0) {
                          <span class="text-muted text-decoration-line-through ms-2">
                            ₹{{ (product.price / (1 - product.discount / 100)) | number:'1.0-0' }}
                          </span>
                        }
                      </div>
                      <span class="badge bg-light text-dark">
                        In Stock
                      </span>
                    </div>
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="d-flex gap-2 mt-auto">
                  <a [routerLink]="['/product', product._id]" class="btn btn-outline-primary flex-grow-1">
                    <i class="bi bi-eye"></i> View Details
                  </a>
                 <div class="d-flex gap-2 mt-3">
  <button 
    class="btn btn-primary btn-sm" 
    (click)="addToCart(product)">
    Add to Cart
  </button>
  <button 
    class="btn btn-outline-success btn-sm" 
    (click)="buyNow(product)">
    Buy Now
  </button>
</div>
                </div>
              </div>
            </div>
          </div>
        }
      </div>

      <!-- Pagination or Load More (Optional) -->
      <div class="text-center mt-5">
        <button class="btn btn-outline-primary">Load More Products</button>
      </div>
    } @else {
      <div class="text-center py-5">
        <div class="empty-state">
          <i class="bi bi-boxes" style="font-size: 4rem; color: #cbd5e0;"></i>
          <h4 class="mt-3">No products found</h4>
          <p class="text-muted">No products available in this category right now.</p>
          <a routerLink="/categories" class="btn btn-primary">Browse All Categories</a>
        </div>
      </div>
    }
  } @else {
    <div class="alert alert-danger text-center py-5">
      <h4>Category Not Found</h4>
      <p class="mb-0">The category you're looking for doesn't exist or has been removed.</p>
      <a routerLink="/categories" class="btn btn-primary mt-3">Browse All Categories</a>
    </div>
  }
</div>

<bajaj-footer></bajaj-footer>

<style>
.hover-lift {
  transition: transform 0.2s ease-in-out;
}

.hover-lift:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
}

.discount-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  z-index: 1;
}

.card-img-container {
  position: relative;
  overflow: hidden;
}

.card-img-container img {
  transition: transform 0.3s ease;
}

.card:hover .card-img-container img {
  transform: scale(1.05);
}
</style>